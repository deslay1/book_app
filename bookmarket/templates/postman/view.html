{% extends "bookmarket/base.html" %}

{% load i18n postman_tags %}{% load pagination_tags %}{% comment %}
WARNING: 'pagination_tags' is a name from the dj-pagination application.
For convenience, the design of this template is done with the use of that application.
Django-postman will still be working, even if that application is not installed, by providing a mock
for the template tag library.
If the real implementation is to be used, just make sure that 'dj_pagination' is declared before 'postman'
in the INSTALLED_APPS setting.
{% endcomment %}

{% load bootstrap %}
{% load i18n %}
{% load bootstrap %}

{% load i18n %}{% load postman_tags %}
{% block content %}


<div id="thisOnes"></div>




<center>




    <div class="activity-section">
        <div class="card4 " id="thisOne1"
            style="color: black; height: auto; align-items: center;  text-align: center;  ">



        </div>


        <div id="scroller" class="commentArea6" style="overflow-y: scroll; background-color: whitesmoke;">


            {% for message in pm_messages %}


            <div id="myDiv" style='border:2px solid;color:white;  ' class="bubbledLeft">

                {{ message.body|linebreaksbr }}


            </div>
            {% if forloop.last %}
        </div>
    </div>
    <div class="activity-section">
        <hr />




        {% if pm_messages|length > 1 %} <form id="formwrap" action="{% url 'postman:reply' reply_to_pk %}?next="
            method="post" onloadeddata="myFunction()" onsubmit="myFunction()">

            <input id="formHelp" type="hidden" name="csrfmiddlewaretoken"
                value="7FsUHgXfZkHOtIvEmUCCXJzoLh0oOwsyBr4pydV9ySziDLrlVTva6M4WkN5eRaNr">

            <div id="pm_reply">{{ form.body }}
            </div>



            <button style="margin-top:1rem;" class="btn btn-primary" type="submit">Send</button>


            <a style="margin-top:1rem; background-color: gray; color: white;" class="btn btn-primary2"
                href="{% url 'postman:inbox' %}">{% csrf_token %} {% trans "Back" %}</a>

            <input id="formHelp" type="hidden" name="csrfmiddlewaretoken"
                value="7FsUHgXfZkHOtIvEmUCCXJzoLh0oOwsyBr4pydV9ySziDLrlVTva6M4WkN5eRaNr">

        </form>


        {% else %}
        <form id="formwrap" action="{% url 'postman:reply' reply_to_pk %}?next={{ next_url|urlencode }}" method="post"
            onloadeddata="myFunction()" onsubmit="myFunction()">

            <input id="formHelp" type="hidden" name="csrfmiddlewaretoken"
                value="7FsUHgXfZkHOtIvEmUCCXJzoLh0oOwsyBr4pydV9ySziDLrlVTva6M4WkN5eRaNr">

            <div id="pm_reply">{{ form.body }}
            </div>



            <button style="margin-top:1rem;" class="btn btn-primary" type="submit">Send</button>


            <a style="margin-top:1rem; background-color: gray; " class="btn btn-primary2" type="submit"
                href="{% url 'postman:inbox' %}">{% trans "Back" %}</a>

            <input id="formHelp" type="hidden" name="csrfmiddlewaretoken"
                value="7FsUHgXfZkHOtIvEmUCCXJzoLh0oOwsyBr4pydV9ySziDLrlVTva6M4WkN5eRaNr">
        </form>{% endif %}







        {% endif %}


        <script>



            var name2 = '<me>';
            var name = '{{ message.obfuscated_sender|or_me:user }}';
            if (name < name2) {
                document.getElementById('myDiv').className = "bubbledRight";
                document.getElementById('myDiv').id = "old";
                document.getElementById('thisOne1').textContent = '{{ message.obfuscated_recipient|or_me:user }}' + "  |  Subject: " + "{{ message.subject }}";




            }
            else {
                document.getElementById('myDiv').className = "bubbledLeft";
                document.getElementById('myDiv').id = "old";
                document.getElementById('thisOne1').textContent = '{{ message.obfuscated_sender|or_me:user }}' + "  |  Subject: " + "{{ message.subject }}";
            } </script>






        {% endfor %}
        <script>

            var objDiv = document.getElementById("scroller");
            objDiv.scrollTop = objDiv.scrollHeight;
        </script>




    </div>


</center>
{% if pm_messages|length > 1 %}{% trans "Conversation" %}


{% else %}{% trans "Message" %}{% endif %}

{% endblock %}